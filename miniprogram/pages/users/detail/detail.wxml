<!--pages/users/detail/detail.wxml-->
<view class="container">
  <!-- åŠ è½½ä¸­ -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <block wx:else>
    <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
    <view class="user-card">
      <view class="user-avatar">
        <text>{{user.name[0] || '?'}}</text>
      </view>
      <view class="user-name">{{user.name}}</view>
      <view class="user-role-tag {{user.role}}">
        {{user.role === 'teacher' ? 'è€å¸ˆ' : 'å­¦ç”Ÿ'}}
      </view>
    </view>

    <!-- è¯¦æƒ…ä¿¡æ¯ -->
    <view class="info-card">
      <view class="info-item">
        <text class="info-label">è§’è‰²</text>
        <text class="info-value">{{user.role === 'teacher' ? 'è€å¸ˆ' : 'å­¦ç”Ÿ'}}</text>
      </view>
      <view class="info-item" wx:if="{{user.subject}}">
        <text class="info-label">ç§‘ç›®</text>
        <text class="info-value">{{user.subject}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">çŠ¶æ€</text>
        <view class="status-tag {{user.bindStatus}}">
          <text wx:if="{{user.bindStatus === 'unbound'}}">ğŸ“ æœªé‚€è¯·</text>
          <text wx:elif="{{user.bindStatus === 'pending'}}">â³ å¾…ç»‘å®š</text>
          <text wx:elif="{{user.bindStatus === 'bound'}}">âœ… å·²ç»‘å®š</text>
          <text wx:elif="{{user.bindStatus === 'registered'}}">ğŸ”— å·²æ³¨å†Œ</text>
        </view>
      </view>
      <view class="info-item" wx:if="{{user.phone}}">
        <text class="info-label">ID</text>
        <text class="info-value">{{user.phone}}</text>
      </view>
      <view class="info-item" wx:if="{{user.remark}}">
        <text class="info-label">å¤‡æ³¨</text>
        <text class="info-value">{{user.remark}}</text>
      </view>
      <view class="info-item" wx:if="{{user.creatorName}}">
        <text class="info-label">åˆ›å»ºäºº</text>
        <text class="info-value">{{user.creatorName}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åˆ›å»ºæ—¶é—´</text>
        <text class="info-value">{{user.createdAtStr}}</text>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-card">
      <!-- é‚€è¯·ç»‘å®š - ä½¿ç”¨ open-type="share" ç›´æ¥è§¦å‘å¾®ä¿¡åˆ†äº« -->
      <button 
        class="action-btn invite" 
        wx:if="{{user.bindStatus === 'unbound' || user.bindStatus === 'pending'}}"
        open-type="share"
      >
        <text class="action-icon">ğŸ“¤</text>
        <text>{{user.bindStatus === 'pending' ? 'é‡æ–°é‚€è¯·' : 'é‚€è¯·ç»‘å®š'}}</text>
      </button>

      <!-- ç¼–è¾‘ä¿¡æ¯ -->
      <button class="action-btn edit" bindtap="handleEdit">
        <text class="action-icon">âœï¸</text>
        <text>ç¼–è¾‘ä¿¡æ¯</text>
      </button>

      <!-- åˆ é™¤ -->
      <button 
        class="action-btn delete" 
        wx:if="{{user.bindStatus === 'unbound'}}"
        bindtap="handleDelete"
      >
        <text class="action-icon">ğŸ—‘ï¸</text>
        <text>åˆ é™¤</text>
      </button>
    </view>

    <!-- é‚€è¯·ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰ -->
    <view class="invite-card" wx:if="{{inviteInfo}}">
      <view class="invite-header">
        <text class="invite-title">ğŸ“¨ é‚€è¯·ä¿¡æ¯</text>
      </view>
      <view class="invite-content">
        <view class="invite-row">
          <text class="invite-label">é‚€è¯·ç </text>
          <text class="invite-code">{{inviteInfo.code}}</text>
        </view>
        <view class="invite-row">
          <text class="invite-label">è¿‡æœŸæ—¶é—´</text>
          <text class="invite-value">{{inviteInfo.expireTimeStr}}</text>
        </view>
        <view class="invite-row">
          <text class="invite-label">çŠ¶æ€</text>
          <text class="invite-value">{{inviteInfo.status === 'pending' ? 'ç­‰å¾…æ¥å—' : 'å·²æ¥å—'}}</text>
        </view>
      </view>
    </view>
  </block>
</view>

