<!--pages/schedule/detail/detail.wxml-->
<view class="container">
  <!-- åŠ è½½ä¸­ -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <block wx:else>
    <!-- è¯¾ç¨‹ä¿¡æ¯å¡ç‰‡ -->
    <view class="info-card main-card">
      <view class="course-header">
        <view class="course-name">{{schedule.courseName}}</view>
        <view class="course-time-badge">
          <text class="time-icon">ğŸ•</text>
          <text>{{schedule.startTime}} - {{schedule.endTime}}</text>
        </view>
      </view>

      <view class="course-date">
        <text class="date-icon">ğŸ“…</text>
        <text>{{schedule.date}} {{schedule.dayOfWeekStr}}</text>
      </view>

      <view class="course-location" wx:if="{{schedule.location}}">
        <text class="location-icon">ğŸ“</text>
        <text>{{schedule.location}}</text>
      </view>
    </view>

    <!-- æ•™å¸ˆä¿¡æ¯ -->
    <view class="info-card">
      <view class="card-title">
        <text class="title-icon">ğŸ‘¨â€ğŸ«</text>
        <text>æˆè¯¾æ•™å¸ˆ</text>
      </view>
      <view class="teacher-info">
        <view class="teacher-avatar">
          <text>{{schedule.teacher.name[0] || '?'}}</text>
        </view>
        <view class="teacher-detail">
          <text class="teacher-name">{{schedule.teacher.name}}</text>
          <text class="teacher-subject" wx:if="{{schedule.teacher.subject}}">{{schedule.teacher.subject}}</text>
        </view>
      </view>
    </view>

    <!-- å­¦ç”Ÿåˆ—è¡¨ -->
    <view class="info-card" wx:if="{{schedule.students.length > 0}}">
      <view class="card-title">
        <text class="title-icon">ğŸ‘¨â€ğŸ“</text>
        <text>å‚ä¸å­¦ç”Ÿ ({{schedule.students.length}}äºº)</text>
      </view>
      <view class="student-list">
        <view class="student-item" wx:for="{{schedule.students}}" wx:key="_id">
          <view class="student-avatar">
            <text>{{item.name[0] || '?'}}</text>
          </view>
          <view class="student-detail">
            <text class="student-name">{{item.name}}</text>
            <text class="student-class" wx:if="{{item.className}}">{{item.className}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å¤‡æ³¨ -->
    <view class="info-card" wx:if="{{schedule.remark}}">
      <view class="card-title">
        <text class="title-icon">ğŸ“</text>
        <text>å¤‡æ³¨</text>
      </view>
      <view class="remark-content">
        {{schedule.remark}}
      </view>
    </view>

    <!-- åˆ›å»ºä¿¡æ¯ -->
    <view class="info-card meta-card">
      <view class="meta-item">
        <text class="meta-label">åˆ›å»ºè€…</text>
        <text class="meta-value">{{schedule.creator.name}}</text>
      </view>
      <view class="meta-item">
        <text class="meta-label">åˆ›å»ºæ—¶é—´</text>
        <text class="meta-value">{{schedule.createdAtStr}}</text>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-area" wx:if="{{canEdit}}">
      <button class="btn-edit" bindtap="handleEdit">
        <text class="btn-icon">âœï¸</text>
        <text>ç¼–è¾‘</text>
      </button>
      <button class="btn-delete" bindtap="handleDelete">
        <text class="btn-icon">ğŸ—‘ï¸</text>
        <text>åˆ é™¤</text>
      </button>
    </view>
  </block>
</view>


